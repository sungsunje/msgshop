<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout}">

<th:block layout:fragment="content">
  <!-- ===== Page-local Styles (네가 준 팔레트에 맞춰 통일) ===== -->
  <style>
    /* ===== 팔레트 ===== */
    :root{
      --page-bg:#0f172a;                  /* 네이비 계열 배경 */
      --text:#f1f5f9;                     /* 거의 화이트 텍스트 */
      --muted:#cbd5e1;

      --card-bg:rgba(255,255,255,.10);    /* 유리 느낌 카드 */
      --card-br:rgba(148,163,184,.35);
      --shadow:0 18px 48px rgba(2,6,23,.55);

      --field-bg:#16223a;                 /* 인풋 바탕 */
      --field-br:#4b5a75;
      --field-br-focus:#7cc0ff;

      --btn-grad:linear-gradient(135deg,#7dd3fc,#a78bfa); /* 하늘→라일락 */
      --danger:#ef4444;
    }

    /* 페이지/텍스트 */
    body{ background:var(--page-bg); color:var(--text); }
    .text-muted{ color:var(--muted) !important; }
    .text-danger{ color:var(--danger) !important; }

    /* 제목 (그라데이션 텍스트) */
    .mp-title{
      margin:0; font-weight:800; letter-spacing:.2px;
      background:var(--btn-grad);
      -webkit-background-clip:text; background-clip:text; color:transparent;
    }

    /* 카드 */
    .mp-card{
      background:var(--card-bg) !important;
      border:1px solid var(--card-br) !important;
      box-shadow:var(--shadow) !important;
      border-radius:16px;
      overflow:hidden;
      height:100%;
    }
    .mp-head{
      padding:.9rem 1.1rem;
      background:linear-gradient(135deg, rgba(79,70,229,.20), rgba(6,182,212,.20));
      border-bottom:1px solid var(--card-br);
      display:flex; align-items:center; justify-content:space-between; gap:.75rem;
    }
    .mp-body{ padding:1.1rem; color:var(--text); }

    /* 인풋/셀렉트/구분자 */
    label.form-label{ color:#e2e8f0 !important; font-weight:600; }
    .form-control, .form-select, .input-group-text{
      background:var(--field-bg) !important;
      color:var(--text) !important;
      border:1px solid var(--field-br) !important;
      box-shadow:none !important;
    }
    .form-control::placeholder{ color:#94a3b8; }
    .form-control:focus, .form-select:focus{
      border-color:var(--field-br-focus) !important;
      outline:none !important;
      box-shadow:0 0 0 .2rem rgba(59,130,246,.15) !important;
    }

    /* 버튼 — 기본 primary/특정 ID 버튼 톤 */
    .btn-primary{
      background:var(--btn-grad) !important;
      border:0 !important;
      color:#0b1020 !important;
      font-weight:700;
    }
    .btn-primary:hover{ filter:brightness(1.05); }

    /* 좌측 메뉴 프래그먼트 내부 링크를 외부에서 톤만 통일 */
    .mp-menu .mp-body a{
      display:flex; align-items:center; gap:.5rem;
      color:var(--text); text-decoration:none;
      padding:.55rem .7rem; border-radius:12px;
      transition: transform .12s, box-shadow .12s, background .12s;
    }
    .mp-menu .mp-body a:hover{
      transform: translateY(-1px);
      box-shadow: 0 10px 22px rgba(2,6,23,.12);
      background: rgba(99,102,241,.12);
    }

    /* 레이아웃 간격 */
    .mp-wrap{ row-gap: 1rem; }
    @media (max-width: 991.98px){
      .col-3, .col-9{ margin-bottom: 1rem; }
    }
  </style>

  <!-- ===== Grid ===== -->
  <div class="row mt-3 mp-wrap">

    <!-- 우측 폼 -->
    <div class="col-12 col-lg-9">
      <div class="mp-card">
        <div class="mp-head">
          <h5 class="mp-title">비밀번호 변경</h5>
        </div>
        <div class="mp-body">
          <form method="post" action="/member/pwchange">
            <div class="mb-3">
              <label for="cur_pw" class="form-label">기존비밀번호</label>
              <input type="password" class="form-control" id="cur_pw" name="cur_pw" placeholder="현재 비밀번호">
            </div>
            <div class="mb-3">
              <label for="new_pw" class="form-label">신규비밀번호</label>
              <input type="password" class="form-control" id="new_pw" name="new_pw" placeholder="신규 비밀번호">
            </div>
            <div class="mb-4">
              <label for="confirm_pw" class="form-label">비밀번호확인</label>
              <input type="password" class="form-control" id="confirm_pw" name="confirm_pw" placeholder="신규 비밀번호 확인">
            </div>

            <div class="d-flex flex-wrap gap-2">
              <button type="button" id="btn_pwchange" class="btn btn-primary">비밀번호 변경하기</button>
            </div>
            <div class="mt-2">
            	<small class="text-muted">※변경하신 비밀번호는 등록된 이메일로 수신됩니다.</small>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</th:block>

<th:block layout:fragment="script2">
<script th:inline="javascript">
$(document).ready(function() {
  $("#btn_pwchange").on("click", function() {
    const cur_pw = $("#cur_pw").val();
    const new_pw = $("#new_pw").val();
    const confirm_pw = $("#confirm_pw").val();

    if(new_pw !== confirm_pw) {
      alert("신규 비밀번호와 확인 비밀번호가 일치하지 않습니다.");
      return;
    }

    $.ajax({
      url: '/member/pwchange',
      type: 'post',
      data: { cur_pw: cur_pw, new_pw: new_pw },
      dataType: 'json',
      success: function(res) {
        if(res.status === "success") {
          alert("비밀번호가 변경되었습니다.");
        } else if(res.status === "fail") {
          alert("현재 비밀번호가 올바르지 않습니다.");
        }
        $("#cur_pw, #new_pw, #confirm_pw").val('');
      },
      error: function(xhr) {
        alert("서버 오류: " + xhr.status);
      }
    });
  });
});
</script>

</th:block>
</html>

