<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout}">

<th:block layout:fragment="content">

  <!-- ====== UI ìŠ¤íƒ€ì¼ ====== -->
  <style>
    :root{
      --page-bg:#0f172a; --text:#f1f5f9; --muted:#cbd5e1;
      --card-bg:rgba(255,255,255,.10); --card-br:rgba(148,163,184,.35);
      --shadow:0 18px 48px rgba(2,6,23,.55);
      --btn-grad:linear-gradient(135deg,#7dd3fc,#a78bfa);
      --chip-bg:rgba(148,163,184,.12);
      --chip-br:rgba(148,163,184,.35);
      --danger:#ef4444;
    }
    body{background:var(--page-bg); color:var(--text);}
    h3{letter-spacing:.2px}

    /* ì¹´ë“œ */
    .card{
      background:var(--card-bg) !important;
      border:1px solid var(--card-br) !important;
      box-shadow:var(--shadow) !important;
      border-radius:16px !important;
      overflow:hidden;
      transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
      cursor:pointer;
    }
    .card:hover{
      transform: translateY(-4px);
      box-shadow: 0 22px 60px rgba(2,6,23,.7) !important;
      border-color: rgba(148,163,184,.55) !important;
    }

    /* ì´ë¯¸ì§€ */
    a.pro_info{display:block; position:relative; overflow:hidden; border-bottom:1px solid var(--card-br);}
    a.pro_info img{transition: transform .6s ease; display:block;}
    a.pro_info::after{
      content:""; position:absolute; inset:0;
      background: linear-gradient(to top, rgba(0,0,0,.45) 0%, rgba(0,0,0,0) 55%);
      pointer-events:none;
    }
    a.pro_info:hover img{transform: scale(1.06);}

    /* í• ì¸ ë±ƒì§€ */
    .badge-top{
      position:absolute; top:10px; left:10px;
      background: var(--danger);
      color:#fff; font-weight:800;
      border-radius:999px; padding:.2rem .6rem; font-size:.8rem;
      box-shadow:0 8px 22px rgba(0,0,0,.35);
    }

    /* íƒ€ì´í‹€ ì˜¤ë²„ë ˆì´ */
    .title-overlay{
      position:absolute; left:12px; bottom:10px; right:12px;
      color:#ecf3ff; font-weight:800; font-size:1.05rem;
      text-shadow: 0 2px 10px rgba(0,0,0,.35);
      overflow:hidden; white-space:nowrap; text-overflow:ellipsis;
      pointer-events:none;
    }

    /* ë³¸ë¬¸ */
    .card-body{display:flex; flex-direction:column; gap:.35rem;}
    .card-title{
      margin:0; font-weight:800; letter-spacing:.1px;
      background:var(--btn-grad);
      -webkit-background-clip:text; background-clip:text; color:transparent;
      font-size:1.05rem;
    }

    /* ê°€ê²© ì˜ì—­ */
    .label{color:#dbeafe; font-weight:700; margin-right:.35rem;}
    .original-price{font-size:.95rem; color:#9ca3af; text-decoration: line-through; margin-right:.5rem;}
    .discounted-price{font-weight:800; font-size:1.15rem; color:var(--danger); margin-right:.35rem;}
    .price-alone{font-weight:800; font-size:1.15rem; color:#ffffff;}
    .discount{font-weight:800; color:var(--danger);}

    /* ì¹© */
    .chip{
      display:inline-flex; 
      align-items:center; 
      gap:.5rem;
      padding:.5rem 1rem;       /* í¬ê¸° í‚¤ì›€ */
      border-radius:999px;
      background:var(--chip-bg); 
      border:1px solid var(--chip-br);
      color:var(--text); 
      font-size:0.95rem;        /* ê¸€ì í‚¤ì›€ */
      font-weight:500;
    }

    .chip span:first-child{font-size:1.1rem;} /* ì´ëª¨ì§€ ì¡°ê¸ˆ í‚¤ì›€ */

    /* ì¹© ì»¨í…Œì´ë„ˆ */
    .chip-container{
      display:flex;
      flex-wrap:wrap;
      gap:10px;                 /* ì¹© ê°„ ê°„ê²© */
      margin-bottom:15px;
    }
    
    /* ìƒë‹¨ ì§€ì—­/í…Œë§ˆ ì¶œë ¥ ìŠ¤íƒ€ì¼ */
	.chip-selected {
	  background: linear-gradient(135deg, #7dd3fc66, #a78bfa66); /* ë°˜íˆ¬ëª… ê·¸ë¼ë””ì–¸íŠ¸ */
	  border: 1px solid #a78bfa;
	  color: #fff;
	  font-weight: 600;
	  box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);
	  margin-top: 30px;
	}
	.chip-selected span:first-child {
	  font-size: 1.2rem;
	}

    .text-body-secondary{color:var(--muted) !important;}
  </style>

  <!-- ====== ì„ íƒëœ ì§€ì—­/í…Œë§ˆ ì¹© ====== -->
  <div class="chip-container">
    <!-- ì§€ì—­ ì¹© -->
    <span th:each="region : ${selectedRegions}" class="chip chip-selected">
      <span>ğŸ—ºï¸</span>
      <span th:text="${region.cate_name}">ì„ íƒëœ ì§€ì—­</span>
    </span>

    <!-- í…Œë§ˆ ì¹© -->
    <span th:each="themeName : ${selectedThemes}" class="chip chip-selected">
      <span>ğŸ“Œ</span>
      <span th:text="${themeName}">ì„ íƒëœ í…Œë§ˆ</span>
    </span>
  </div>

  <!-- ìˆ¨ì€ í¼ -->
  <form id="frm_pro_info" method="get" action="/product/pro_info">
    <input type="hidden" name="cate_name" id="cate_name">
    <input type="hidden" name="pro_num" id="pro_num">
  </form>

  <!-- ì¹´ë“œ ë¦¬ìŠ¤íŠ¸ -->
  <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-4"> <!-- ê°„ê²© ì¡°ê¸ˆ í‚¤ì›€ -->
    <div class="col" th:each="productVo : ${pro_list}">
      <div class="card shadow-sm h-100">
        <a href="#" th:data-pro_num="${productVo.pro_num}" class="pro_info">
          <img style="width:100%; height:220px; object-fit:cover;"
     th:src="@{'/product/image_display'(dateFolderName=${productVo.pro_up_folder}, fileName='s_' + ${productVo.pro_img})}"
     th:alt="${productVo.pro_name}">

          <span class="badge-top"
                th:if="${productVo.pro_discount != null and productVo.pro_discount > 0}"
                th:text="${productVo.pro_discount + '% OFF'}">10% OFF</span>
        </a>
        <div class="card-body">
          <h5 class="card-title" th:text="${productVo.pro_name}">ì—…ì²´ëª…</h5>
          <p class="card-text mb-1">
            <span class="label">ëŒ€í‘œìš”ê¸ˆ</span>
            <span th:if="${productVo.pro_discount != null and productVo.pro_discount > 0}">
              <span class="original-price"
                    th:text="${#numbers.formatInteger(productVo.pro_price, 3, 'COMMA') + 'ì›'}">0ì›</span>
              <span class="discounted-price"
                    th:text="${#numbers.formatInteger(productVo.pro_price - (productVo.pro_price * productVo.pro_discount / 100), 3, 'COMMA') + 'ì›'}">0ì›</span>
              <span class="discount" th:text="${'Â· ' + productVo.pro_discount + '% í• ì¸'}">Â· 10% í• ì¸</span>
            </span>
            <span th:if="${productVo.pro_discount == null or productVo.pro_discount == 0}">
              <span class="price-alone"
                    th:text="${#numbers.formatInteger(productVo.pro_price, 3, 'COMMA') + 'ì›'}">0ì›</span>
            </span>
          </p>
          <!-- ì§€ì—­ ë° í…Œë§ˆ ì¹© -->
<div class="mb-2">
    <!-- ì²« ì¤„: ì§€ì—­ëª… -->
    <span class="chip">
        <span>ğŸ—ºï¸</span>
        <span th:text="${productVo.cate_name}">ì§€ì—­ëª…</span>
    </span>
</div>

<!-- ë‘˜ì§¸ ì¤„: í…Œë§ˆëª… ë°˜ë³µ -->
<div class="d-flex flex-wrap gap-2">
    <span th:each="themeName : ${productVo.themeList}" class="chip">
        <span>ğŸ“Œ</span>
        <span th:text="${themeName}">í…Œë§ˆëª…</span>
    </span>
</div>

          <p class="card-text mt-auto">
            <small class="text-body-secondary">ì´ìš©í›„ê¸°:
              <span th:text="${productVo.pro_review}">0</span>ê±´
            </small>
          </p>
        </div>
      </div>
    </div>
  </div>

</th:block>

<th:block layout:fragment="script2">
<script th:inline="javascript">
  $(".card").on("click", function(e) {
    e.preventDefault();
    let pro_num = $(this).find("a.pro_info").data("pro_num");
    $("#pro_num").val(pro_num);
    $("#cate_name").val('[[${cate_name}]]');
    $("#frm_pro_info").submit();
  });
</script>
</th:block>

</html>
